{"ast":null,"code":"var _jsxFileName = \"/Users/anjonghun/Desktop/4\\u1112\\u1161\\u11A8\\u1102\\u1167\\u11AB 2\\u1112\\u1161\\u11A8\\u1100\\u1175/\\u110B\\u1170\\u11B8\\u1111\\u1173\\u11AF\\u1106\\u1175\\u11BC/final_project/client/src/components/post/EditPost.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useRef, useEffect } from \"react\";\nimport styled from \"styled-components\";\nimport moment from \"moment\";\nimport Cookies from \"js-cookie\";\nimport axios from \"axios\";\nimport { useNavigate, useLocation } from \"react-router-dom\";\nimport { Empty } from \"antd\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst PostPanel = styled.div`\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  font-size: 20px;\n  text-align: center;\n  align-items: center;\n\n  .content {\n    height: 500px;\n    width: 1000px;\n  }\n  div {\n    margin: 10px;\n  }\n  .exist {\n    border: none;\n    background-color: 0;\n  }\n`;\n_c = PostPanel;\n\nfunction EditPost() {\n  _s();\n\n  const location = useLocation();\n  const id = location.state.id;\n  const [imageFilenames, setImage] = useState([]);\n  const navigate = useNavigate();\n  const images = [];\n  const [inputPost, setPost] = useState({\n    number: \"\",\n    id: \"\",\n    date: \"\",\n    contents: \"\"\n  });\n  useEffect(() => {\n    (async () => {\n      const temp = location.state.images;\n\n      for (let i in temp[0]) {\n        if (temp[0][i] !== null) {\n          if (i !== \"number\") images.push(temp[0][i]);\n        }\n\n        setImage(images);\n      }\n\n      setPost({ ...inputPost,\n        number: location.state.number,\n        id: location.state.id,\n        contents: location.state.contents\n      });\n    })();\n  }, []);\n  const formData = new FormData();\n\n  const existFileClick = async e => {\n    let idx = e.target.id;\n    document.getElementById(idx).style.display = \"none\";\n    delete imageFilenames[idx];\n    let filtered = imageFilenames.filter(function (el) {\n      return el != null;\n    });\n    setImage(filtered);\n  };\n\n  const handleChangeFile = async e => {\n    if (e.target.files.length > 5 - imageFilenames.length) {\n      alert(\"파일 최대 5개만 선택가능 다시 선택하세요.\");\n    } else {\n      for (let i = 0; i < 5; i++) {\n        formData.append(\"img\", e.target.files[i]);\n      }\n    }\n  };\n\n  const handleChangePost = e => {\n    let date = moment().format(\"YYYY-MM-DD HH:mm\");\n    setPost({ ...inputPost,\n      contents: e.target.value,\n      id: id,\n      date: date\n    });\n  };\n\n  const subimtOnClick = async e => {\n    const config = {\n      header: {\n        \"content-type\": \"multipart/form-data\"\n      }\n    };\n\n    try {\n      //let result = await axios.post(\"/write/uploadImages\", formData, config);\n      let result2 = await axios.post(\"/write/updatePost\", inputPost);\n    } catch (err) {\n      alert(\"지원하지않는 파일존재\\n 다른 이미지 파일을 넣어주세요.\");\n    }\n\n    navigate(\"/home\");\n  };\n\n  const deleteOnClick = async () => {\n    try {\n      let result = await axios.post(\"/write/deletePost\", inputPost);\n      navigate(\"/home\");\n    } catch {}\n  };\n\n  return /*#__PURE__*/_jsxDEV(PostPanel, {\n    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n      className: \"content\",\n      placeholder: \"\\uB0B4\\uC6A9\\uC785\\uB825\",\n      type: \"email\",\n      value: inputPost.contents,\n      onChange: handleChangePost\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"file\",\n      className: \"file\",\n      id: \"file\",\n      name: \"img\",\n      onChange: handleChangeFile,\n      multiple: \"multiple\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"\\uC874\\uC7AC\\uD558\\uB294 \\uD30C\\uC77C \\uD074\\uB9AD \\uC2DC \\uC0AD\\uC81C\\uB428\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 9\n      }, this), \"\\uD604\\uC7AC \\uC874\\uC7AC\\uD558\\uB294\\uD30C\\uC77C\", imageFilenames.map((fname, idx) => /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"exist\",\n        id: idx,\n        onClick: existFileClick,\n        children: fname\n      }, fname, false, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 11\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"submit\",\n      onClick: subimtOnClick,\n      children: \"\\uC218\\uC815\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: deleteOnClick,\n      children: \"\\uAC8C\\uC2DC\\uBB3C \\uC0AD\\uC81C\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 115,\n    columnNumber: 5\n  }, this);\n}\n\n_s(EditPost, \"B7aVfQZcbFr/p4YCUvdjY3oKqaA=\", false, function () {\n  return [useLocation, useNavigate];\n});\n\n_c2 = EditPost;\nexport default EditPost;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"PostPanel\");\n$RefreshReg$(_c2, \"EditPost\");","map":{"version":3,"sources":["/Users/anjonghun/Desktop/4학년 2학기/웹플밍/final_project/client/src/components/post/EditPost.js"],"names":["React","useState","useRef","useEffect","styled","moment","Cookies","axios","useNavigate","useLocation","Empty","PostPanel","div","EditPost","location","id","state","imageFilenames","setImage","navigate","images","inputPost","setPost","number","date","contents","temp","i","push","formData","FormData","existFileClick","e","idx","target","document","getElementById","style","display","filtered","filter","el","handleChangeFile","files","length","alert","append","handleChangePost","format","value","subimtOnClick","config","header","result2","post","err","deleteOnClick","result","map","fname"],"mappings":"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","sourcesContent":["import React, { useState, useRef, useEffect } from \"react\";\nimport styled from \"styled-components\";\nimport moment from \"moment\";\nimport Cookies from \"js-cookie\";\nimport axios from \"axios\";\nimport { useNavigate, useLocation } from \"react-router-dom\";\nimport { Empty } from \"antd\";\n\nconst PostPanel = styled.div`\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  font-size: 20px;\n  text-align: center;\n  align-items: center;\n\n  .content {\n    height: 500px;\n    width: 1000px;\n  }\n  div {\n    margin: 10px;\n  }\n  .exist {\n    border: none;\n    background-color: 0;\n  }\n`;\n\nfunction EditPost() {\n  const location = useLocation();\n  const id = location.state.id;\n  const [imageFilenames, setImage] = useState([]);\n  const navigate = useNavigate();\n  const images = [];\n  const [inputPost, setPost] = useState({\n    number: \"\",\n    id: \"\",\n    date: \"\",\n    contents: \"\",\n  });\n\n  useEffect(() => {\n    (async () => {\n      const temp = location.state.images;\n      for (let i in temp[0]) {\n        if (temp[0][i] !== null) {\n          if (i !== \"number\") images.push(temp[0][i]);\n        }\n        setImage(images);\n      }\n\n      setPost({\n        ...inputPost,\n        number: location.state.number,\n        id: location.state.id,\n        contents: location.state.contents,\n      });\n    })();\n  }, []);\n\n  const formData = new FormData();\n\n  const existFileClick = async (e) => {\n    let idx = e.target.id;\n    document.getElementById(idx).style.display = \"none\";\n    delete imageFilenames[idx];\n    let filtered = imageFilenames.filter(function (el) {\n      return el != null;\n    });\n    setImage(filtered);\n  };\n  const handleChangeFile = async (e) => {\n    if (e.target.files.length > 5 - imageFilenames.length) {\n      alert(\"파일 최대 5개만 선택가능 다시 선택하세요.\");\n    } else {\n      for (let i = 0; i < 5; i++) {\n        formData.append(\"img\", e.target.files[i]);\n      }\n    }\n  };\n\n  const handleChangePost = (e) => {\n    let date = moment().format(\"YYYY-MM-DD HH:mm\");\n    setPost({\n      ...inputPost,\n      contents: e.target.value,\n      id: id,\n      date: date,\n    });\n  };\n\n  const subimtOnClick = async (e) => {\n    const config = {\n      header: { \"content-type\": \"multipart/form-data\" },\n    };\n    try {\n      //let result = await axios.post(\"/write/uploadImages\", formData, config);\n      let result2 = await axios.post(\"/write/updatePost\", inputPost);\n    } catch (err) {\n      alert(\"지원하지않는 파일존재\\n 다른 이미지 파일을 넣어주세요.\");\n    }\n    navigate(\"/home\");\n  };\n\n  const deleteOnClick = async () => {\n    try {\n      let result = await axios.post(\"/write/deletePost\", inputPost);\n      navigate(\"/home\");\n    } catch {}\n  };\n\n  return (\n    <PostPanel>\n      <input\n        className=\"content\"\n        placeholder=\"내용입력\"\n        type=\"email\"\n        value={inputPost.contents}\n        onChange={handleChangePost}\n      />\n      <input\n        type=\"file\"\n        className=\"file\"\n        id=\"file\"\n        name=\"img\"\n        onChange={handleChangeFile}\n        multiple=\"multiple\"\n      />\n      <div>\n        <div>존재하는 파일 클릭 시 삭제됨</div>\n        현재 존재하는파일\n        {imageFilenames.map((fname, idx) => (\n          <button\n            className=\"exist\"\n            key={fname}\n            id={idx}\n            onClick={existFileClick}\n          >\n            {fname}\n          </button>\n        ))}\n      </div>\n\n      <button type=\"submit\" onClick={subimtOnClick}>\n        수정\n      </button>\n      <button onClick={deleteOnClick}>게시물 삭제</button>\n    </PostPanel>\n  );\n}\n\nexport default EditPost;\n"]},"metadata":{},"sourceType":"module"}